\chapter{Some examples of well-switching rewriting systems}

\subsubsection{Some examples of well-switching rewriting systems}

\subsubsection{Equipping hypergraphs with equivalences}


Moreover, we next observe that various classes of rewriting systems,
comprising all the ones used in modelling the applications to the
encoding of process calculi or of bio and chemical systems mentioned
in the introduction, are actually well-switching.

\todo{da fare}

\todo{Questa sezione Ã¨ da riscrivere bene ma penso vada incorporata nella sez sui well.behaved}

A first class consists of those rewriting systems over
possibly hierarchical graphical structures obtained as algebras of
suitable signatures where rules are constrained not to merge elements
of top level sorts in the hierarchy (for graphs, nodes can be
merged while edges cannot). The idea here is to consider graph
structures as presheaves on categories in which there are objects that play 
the role of \emph{roots}, i.e.~objects that are not the codomain of 
any arrow besides the identity. 

\begin{definition}[Root-preserving graphical rewriting systems]
	Let $\X$ be a category, an object $X\in \X$ is a \emph{root} if the only arrow with codomain $X$ is $\id{X}$.
	The category $\gph{X}$ of \emph{$\X$-graphs} is the category
	$\Set^{\X}$. A
	\emph{root-preserving graphical rewriting system} is a left-linear
	rewriting system $(\gph{X}, \R)$ such that for each rule
	$(l\colon K\to L, r\colon K\to R)$ in $\R$ it holds
	\begin{enumerate}
		\item for every $X\in \X$ and $x\in L(X)$, there exists a root $Y$
		and an arrow $f\colon Y\to X$ such that $x$ belongs to the image of
		$L(f)\colon L(Y)\to L(X)$;
		\item $r\colon K\to R$ is mono on the roots, i.e.~for every root $X\in \X$ the component $r_X:K(X)\to R(X)$ is injective.
	\end{enumerate}
\end{definition}

For instance, the category $\cat{Graph}$ can be obtained
by taking as $\X$ the category generated by $E \rightrightarrows V$. In this case $E$ is the only root, hence, condition $1$ asks that in the left-hand side of each rule
there are no isolated nodes, while condition $2$ asks that the
morphism $r: K \to R$ is injective on edges, i.e.~it can only merge nodes.

\begin{lemma}{lemma}{lemVTame}
	\label{bono}
	All root-preserving graphical rewriting systems are well-switching.
\end{lemma}

Another interesting class of well-switching rewriting systems is given by e-graphs.

\begin{example}[E-graphs]
	Consider the category $\cat{EGraphs}$, where objects are (directed)
	graphs endowed with an equivalence over nodes, and arrows are graph
	morphisms that preserve the equivalence, as considered
	in~\cite{BaldanGM06}, closely related to e-graphs~\cite{WNW:egg}. 
	Formally, $\cat{EGraphs}$ can be seen as the
	subcategory of the presheaf
	$[E \rightrightarrows V \to Q, \cat{Set}]$ where objects are
	constrained to have the component $V \to Q$ surjective. 
	
	Explicitly, an
	e-graph $G$ is a triple $\langle s_G, t_G, q_G \rangle$ where
	$s_G, t_G: E_G \rightrightarrows V_G$ provides the graphical
	structure, while the surjective function $q_G : V_G \to Q_G$ maps
	each node to the corresponding equivalence class. 
	Notice that the inclusion functor into  $[E \rightrightarrows V \to Q, \cat{Set}]$ 
	creates pullbacks and pushouts \cite{mac2013categories}, so that they are computed component-wise.
	
	A morphism in $\cat{EGraph}$ is mono if the components over $E$
	and $V$ are mono, i.e.~if it is mono as a morphism in
	$\cat{Graph}$. It is regular mono if also the component on
	$Q$ is mono, i.e.~if it reflects equivalence classes besides
	preserving them. This characterisation of regular monos and the fact that pullbacks and pushouts are computed component-wise allows us to prove quasi-adhesivity of $\cat{EGraphs}$ at once. Moreover, one can deduce that every rewriting system $(\X, \R)$ that is left-linear with respect to $\reg(\cat{EGraphs})$ is strong enforcing: this is done exploiting again the inclusion functor into $[E \rightrightarrows V \to Q, \cat{Set}]$.
	
	Left-linear rewriting systems with respect to $\reg(\cat{EGraphs})$ are well-switching. They have been used in~\cite{BaldanGM06} for the graphical implementation of nominal calculi, where,
	differently from~\cite{Gad07}, as a result of name passing the received name is not merged with a local one, but put in the same equivalence class, better tracing the causal dependencies among reductions.
\end{example}



\section{A class of well-behaved left-linear DPO rewriting systems}
